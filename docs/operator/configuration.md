# Gardener Syncer Configuration

## Configuration Parameters

The table below describes parameters exposed as user configuration to customize the Gardener Syncer job:

| Parameter    | Description                                                                                              |
|--------------|----------------------------------------------------------------------------------------------------------|
| **logLevel** | Logging level for the application. Possible values are `INFO`, `DEBUG`.                                  |
| **schedule** | Cron schedule for the job. This defines how often the job will run to fetch the Seed data from Gardener. |


## Helm chart configuration

It configures the Gardener Syncer job and its dependencies.
Besides two parameters described above that can be possibly overriden, the user generally should not modify the internal Helm chart configuration.  
Helm chart configuration parameters are organized into five main sections:

- `jobs.syncer` - Main configuration for the Gardener Syncer job.
- `gardener.credentials` - Configuration for a kubeconfig file providing access to Gardener Cluster. The file is mounted in the pod from the secret.
- `converterConfig` - Configuration for a Gardener shoot converter configuration file. (default "/converter-config/converter_config.json"). The file is mounted in the pod from the config map.
- `serviceAccount` - Configuration for the service account used by the Gardener Syncer job.
- `argosap` - Internal configuration for the ArgoCD application that deploys the Gardener Syncer job. Its parameters are internal and are not described here.

The table below describes the available parameters:

| Argument                            | Description                                                                                                                                                                                                      |
|-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **jobs.syncer.namespace**           | Namespace where the Gardener Syncer job will be deployed. This is the namespace where the job will run and store its data (default `"kcp-system"`)                                                               |
| **jobs.syncer.seedMapName**         | Name of the ConfigMap where the Seed data will be stored. This ConfigMap is used to cache the Seed data fetched from Gardener (default `"gardener-seeds-cache"`)                                                 |
| **jobs.syncer.logLevel**            | Logging level for the application. Possible values are `INFO`, `DEBUG`. This controls the verbosity of the logs generated by the application (default `"INFO"`).                                                 |
| **jobs.syncer.schedule**            | Cron schedule for the job. This defines how often the job will run to fetch the Seed data from Gardener (default `"0 2,14 * * *"`, which means it runs at 2 AM and 2 PM every day).                              |
| **jobs.syncer.image.registry**      | Container image registry for the Gardener Syncer job. This is the registry where the Gardener Syncer image is stored (default `"europe-docker.pkg.dev"`)                                                         |
| **jobs.syncer.image.repository**    | Container image repository for the Gardener Syncer job. This is the repository where the Gardener Syncer image is stored (default `"kyma-project/prod/gardener-syncer"`)                                         |
| **jobs.syncer.image.pullPolicy**    | Container image pull policy for the Gardener Syncer job. This defines how the container image will be pulled (default `"IfNotPresent"`)                                                                          |
| **gardener.credentials.secretName** | The name of the Kubernetes Secret containing the kubeconfig file for accessing the Gardener API. This Secret must be created in the same namespace as the Gardener Syncer job (default `"gardener-credentials"`) |
| **gardener.credentials.mountpath**  | The mount path for the kubeconfig file inside the Gardener Syncer job pod. This is where the kubeconfig file will be accessible (default `"/gardener/kubeconfig"`)                                               |
| **gardener.credentials.kubeconfig** | The name of the kubeconfig file inside the mounted secret. This is the file that contains the credentials and configuration for accessing the Gardener API (default `"kubeconfig"`)                              |
| **converterConfig.name**            | Name of the ConfigMap containing the Gardener shoot converter configuration file. (default `"infrastructure-manager-converter-config"`)                                                                          |
| **converterConfig.mountPath**       | Mount path for the Gardener shoot converter configuration file inside the Gardener Syncer job pod. This is where the configuration file will be accessible (default `"/converter-config"`)                       |
| **converterConfig.key**             | The key in the ConfigMap that contains the Gardener shoot converter configuration file. This is the specific entry in the ConfigMap that holds the configuration (default `"converter_config.json"`)             |
| **converterConfig.path**            | The file path where the Gardener shoot converter configuration file will be mounted inside the Gardener Syncer job pod (default `"/converter-config/converter_config.json"`)                                     |
| **serviceAccount.create**           | Whether to create a service account for the Gardener Syncer job. If set to `true`, a service account will be created (default `true`)                                                                            |
| **serviceAccount.name**             | Name of the service account to be used by the Gardener Syncer job. If not specified, If not set and create is true, a name will be generated (default `"gardener-syncer"`)                                       |


## Program Arguments

The Gardener Syncer application accepts several command-line arguments that can be used to customize its behavior. 
These arguments are set in the Helm chart and can be overridden by user configuration. 
The table below describes the available arguments:

| Argument                          | Description                                                                                                                                                                   |
|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **--gardener-timeout**            | Timeout of the Gardener API call. This timeout is used to cancel the API call if it takes longer than the specified duration (default `5s`)                                     |
| **--gardener-kubeconfig-pathconverter-config-filepath**   | File path to the gardener shoot converter configuration. (default `"/converter-config/converter_config.json"`). The file is mounted to the pod as a volume from the config map. |
| **--gardener-kubeconfig-path**    | File path to the kubeconfig file providing access to Gardener Cluster where seed information is present. The file is mounted to the pod as a volume from the secret.          |
| **--gardener-seed-map-name**      | Name of the output ConfigMap where the region seed data will be stored. This ConfigMap is used to cache the Seed data fetched from Gardener (default `"gardener-seeds-cache"`)  |
| **--gardener-seed-map-namespace** | Namespace of the ConfigMap where the Gardener Seed region data will be stored. This ConfigMap is used to cache the Seed data fetched from Gardener (default `"kcp-system"`)     |
| **--log-level**                   | Logging level for the application. Possible values are `INFO`, `DEBUG`. This controls the verbosity of the logs generated by the application (default `"INFO"`)                 |

